<!DOCTYPE html>
<html>
<head>
    <title>Scan Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        pre { background-color: #f8f9fa; padding: 10px; overflow-x: auto; max-height: 200px; }
        .badge-High { background-color: #dc3545; }
        .badge-Medium { background-color: #ffc107; }
        .badge-Low { background-color: #0d6efd; }
        .badge-Critical { background-color: #6f42c1; }
    </style>
</head>
<body class="bg-light">
<div class="container mt-5">
    <h2 class="mb-4">Scan Results for <code>{{ url }}</code></h2>
    {% if findings %}
        <div class="row">
        {% for item in findings %}
            <div class="col-md-6">
                <div class="card mb-4 shadow">
                    <div class="card-header">
                        <strong>{{ item.vulnerability }}</strong>
                        <span class="badge float-end badge-{{ item.severity }}">{{ item.severity }}</span>
                    </div>
                    <div class="card-body">
                        <p><strong>Payload:</strong> <code>{{ item.payload }}</code></p>
                        <p><strong>Method:</strong> {{ item.method.upper() }}</p>
                        <p><strong>Param(s):</strong> {{ item.param_names | join(', ') }}</p>
                        <p><strong>URL:</strong> {{ item.url }}</p>
                        <p><strong>Evidence:</strong></p>
                        <pre>{{ item.evidence }}</pre>
                    </div>
                </div>
            </div>
        {% endfor %}
        </div>
        {% if report_file %}
            <a class="btn btn-success me-2" href="{{ url_for('download_report', filename=report_file) }}">Download CSV Report</a>
        {% endif %}
        {% if pdf_file %}
            <a class="btn btn-danger" href="{{ url_for('download_report', filename=pdf_file) }}">Download PDF Report</a>
        {% endif %}
    {% else %}
        <div class="alert alert-info">No vulnerabilities found or scan failed.</div>
    {% endif %}
    <a href="/" class="btn btn-secondary mt-3">‚Üê Back to Home</a>
</div>
</body>
</html>